<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Alamo’s Club - Control Interno</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* === ESTILOS GENERALES === */
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background-color: #000;
      color: white;
      font-family: 'Poppins', sans-serif;
      overflow-x: hidden;
      text-align: center;
    }

    /* === ANIMACIÓN DE INICIO === */
    #intro {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: black;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      animation: fadeOut 2.8s ease forwards;
      animation-delay: 2.2s;
      z-index: 10;
    }

    #intro img {
      width: 160px;
      max-width: 40%;
      opacity: 0;
      animation: zoomLogo 2s ease forwards;
    }

    #intro h1 {
      font-size: 2.4em;
      margin-top: 15px;
      opacity: 0;
      animation: showText 2s ease forwards 1.4s;
      color: #f1c40f;
      word-wrap: break-word;
    }

    @keyframes zoomLogo {
      0% { transform: scale(0.2); opacity: 0; }
      50% { transform: scale(1.3); opacity: 1; }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes showText {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeOut {
      to { opacity: 0; visibility: hidden; }
    }

    /* === LOGIN === */
    #login {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background: radial-gradient(circle at center, #111 0%, #000 100%);
      transition: opacity 0.8s;
      padding: 10px;
    }

    #login img {
      width: 160px;
      max-width: 40%;
      margin-bottom: 20px;
      border-radius: 50%;
    }

    input[type="password"] {
      padding: 16px;
      border-radius: 8px;
      border: none;
      width: 70%;
      max-width: 400px;
      font-size: 20px;
      margin-bottom: 20px;
      text-align: center;
    }

    button {
      background: #e91e63;
      border: none;
      color: white;
      font-weight: bold;
      border-radius: 10px;
      padding: 16px 32px;
      cursor: pointer;
      font-size: 20px;
      transition: 0.3s;
      word-wrap: break-word;
    }

    button:hover { background: #ff4081; }

    /* === PANEL PRINCIPAL === */
    #panel {
      display: none;
      height: 100vh;
      background-color: #111;
      flex-direction: column;
      overflow-x: hidden;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 25px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .header img {
      width: 100px;
      max-width: 30%;
      height: 100px;
      object-fit: cover;
      border-radius: 50%;
    }

    .content {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      gap: 20px;
      padding: 10px;
    }

    .menu-btn {
      width: 80%;
      max-width: 300px;
      padding: 20px;
      font-size: 24px;
      border-radius: 16px;
      background: linear-gradient(135deg, #e91e63, #f1c40f);
      color: black;
      font-weight: bold;
      transition: 0.3s;
    }

    .menu-btn:hover { transform: scale(1.05); }

    /* === PANEL DE VENTAS COMO TABLA === */
    #ventasPanel {
      display: none;
      padding: 20px;
      text-align: center;
    }

    table.ventasTable {
      width: 100%;
      max-width: 600px;
      margin: 0 auto 20px;
      border-collapse: separate;
      border-spacing: 15px 10px;
    }

    table.ventasTable td {
      vertical-align: middle;
      font-size: 22px;
      text-align: center;
    }

    table.ventasTable td button {
      width: 50px;
      height: 50px;
      font-size: 24px;
      border-radius: 10px;
      margin: 0 5px;
    }

    #total {
      font-size: 28px;
      margin-bottom: 20px;
      word-wrap: break-word;
    }

    #ventasPanel button.volver-btn {
      margin-top: 10px;
      padding: 14px 30px;
      font-size: 20px;
      border-radius: 12px;
    }

    /* === LISTA DE INVITADOS === */
    #invitadosPanel {
      display: none;
      padding: 20px;
      max-height: 80vh;
      overflow-y: auto;
      text-align: center;
    }

    .nombre {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      background: #222;
      padding: 15px;
      border-radius: 12px;
      margin: 8px 0;
      font-size: 20px;
      align-items: center;
      gap: 10px;
    }

    .nombre button {
      background: #27ae60;
      font-size: 18px;
      padding: 10px 20px;
      border-radius: 10px;
      word-wrap: break-word;
    }

    .nombre button:disabled { background: gray; }

    input#buscar {
      font-size: 18px;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: none;
      width: 80%;
      max-width: 400px;
    }

    /* === BARRA DE PROGRESO === */
    .progress-container {
      display: flex;
      align-items: center;
      margin: 20px auto;
      justify-content: center;
      width: 90%;
      max-width: 600px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .progress-icon {
      width: 50px;
      max-width: 15%;
      height: 50px;
      object-fit: contain;
      flex-shrink: 0;
    }

    .progress-bar {
      flex: 1;
      height: 20px;
      background: #333;
      border-radius: 15px;
      overflow: hidden;
      position: relative;
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #f1c40f, #e91e63);
      transition: width 0.5s ease;
    }

    /* === MEDIA QUERIES PARA RESPONSIVE === */
    @media (max-width: 768px) {
      .menu-btn { font-size: 20px; padding: 16px; }
      table.ventasTable td { font-size: 20px; }
      table.ventasTable td button { width: 45px; height: 45px; font-size: 20px; }
      #total { font-size: 24px; }
      .nombre { font-size: 18px; padding: 12px; }
      .nombre button { font-size: 16px; padding: 8px 16px; }
      input#buscar { font-size: 16px; }
      .progress-bar { height: 15px; }
      .progress-icon { width: 40px; height: 40px; }
    }

    @media (max-width: 480px) {
      .menu-btn { font-size: 18px; padding: 12px; }
      table.ventasTable td { font-size: 18px; }
      table.ventasTable td button { width: 40px; height: 40px; font-size: 18px; }
      #total { font-size: 20px; }
      .nombre { font-size: 16px; padding: 10px; flex-direction: column; gap: 5px; }
      .nombre button { font-size: 14px; padding: 6px 12px; }
      input#buscar { font-size: 14px; }
      .progress-bar { height: 12px; }
      .progress-icon { width: 30px; height: 30px; }
    }
  </style>
</head>
<body>

  <!-- ANIMACIÓN INICIAL -->
  <div id="intro">
    <img src="LOGO.PNG" alt="Logo">
    <h1>Bienvenido</h1>
  </div>

  <!-- LOGIN -->
  <div id="login">
    <img src="logotipo.png" alt="Logotipo">
    <input type="password" id="password" placeholder="Contraseña">
    <button onclick="login()">Ingresar</button>
  </div>

  <!-- PANEL PRINCIPAL -->
  <div id="panel">
    <div class="header">
      <img src="LOGO.PNG" alt="Logo">
      <img src="logotipo.png" alt="Logotipo">
    </div>
    <div class="content" id="menuPrincipal">
      <button class="menu-btn" onclick="mostrarVentas()">Barra</button>
      <button class="menu-btn" onclick="mostrarInvitados()">Lista de Invitados</button>
    </div>

    <!-- Panel de Ventas -->
    <div id="ventasPanel">
      <h2 style="font-size: 36px;">Registro de Ventas</h2>
      <table class="ventasTable">
        <tr>
          <td>Promoción ($250)</td>
          <td>
            <button onclick="modificar('promo', -1)">−</button>
            <span id="promoCount">0</span>
            <button onclick="modificar('promo', 1)">+</button>
          </td>
        </tr>
        <tr>
          <td>Unidad ($150)</td>
          <td>
            <button onclick="modificar('unidad', -1)">−</button>
            <span id="unidadCount">0</span>
            <button onclick="modificar('unidad', 1)">+</button>
          </td>
        </tr>
        <tr>
          <td>Total:</td>
          <td><span id="total">₱0</span></td>
        </tr>
      </table>
      <button onclick="pagar()">Pagar</button>
      <button class="volver-btn" onclick="volverMenu()">Volver</button>
    </div>

    <!-- Lista de Invitados -->
    <div id="invitadosPanel">
      <h2 style="font-size: 36px;">Lista de Invitados</h2>

      <!-- Barra de progreso -->
      <div class="progress-container">
        <img src="LOGO.PNG" alt="Logo" class="progress-icon">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <img src="FLAG.PNG" alt="Meta" class="progress-icon">
      </div>

      <input type="text" id="buscar" placeholder="Buscar nombre...">
      <div id="output"></div>
      <button onclick="volverMenu()">Volver</button>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDLW12w5ZznypXJYMrTNouttdX0vrG6Bzg",
      authDomain: "alamos-club-d1847.firebaseapp.com",
      projectId: "alamos-club-d1847",
      storageBucket: "alamos-club-d1847.firebasestorage.app",
      messagingSenderId: "666754924136",
      appId: "1:666754924136:web:03b63136a94e98515d45dd",
      measurementId: "G-MNFMT9QLBN"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // LOGIN
    function login() {
      const pass = document.getElementById("password").value;
      if (pass === "12345") {
        document.getElementById("login").style.display = "none";
        document.getElementById("panel").style.display = "flex";
      } else if (pass === "Aldoariel2") {
        alert("⚙️ Perfil socio (pendiente de configurar)");
      } else {
        alert("❌ Contraseña incorrecta");
      }
    }

    // PANEL DE VENTAS
    let promo = 0, unidad = 0;

    function mostrarVentas() {
      document.getElementById("menuPrincipal").style.display = "none";
      document.getElementById("ventasPanel").style.display = "block";
    }

    function modificar(tipo, valor) {
      if (tipo === "promo") promo = Math.max(0, promo + valor);
      if (tipo === "unidad") unidad = Math.max(0, unidad + valor);
      actualizarTotal();
    }

    function actualizarTotal() {
      const total = promo * 250 + unidad * 150;
      document.getElementById("promoCount").textContent = promo;
      document.getElementById("unidadCount").textContent = unidad;
      document.getElementById("total").textContent = "$" + total;
    }

    async function pagar() {
      const total = promo * 250 + unidad * 150;
      if (total === 0) {
        alert("⚠️ No hay productos en la venta");
        return;
      }
      try {
        await db.collection("ventas").add({
          fecha: new Date(),
          promociones: promo,
          unidades: unidad,
          total: total
        });
        alert("✅ Venta registrada correctamente.");
        promo = 0; unidad = 0;
        actualizarTotal();
      } catch (e) {
        alert("❌ Error al registrar venta: " + e.message);
      }
    }

    function volverMenu() {
      document.getElementById("ventasPanel").style.display = "none";
      document.getElementById("invitadosPanel").style.display = "none";
      document.getElementById("menuPrincipal").style.display = "flex";
    }

    // LISTA DE INVITADOS
    async function mostrarInvitados() {
      document.getElementById("menuPrincipal").style.display = "none";
      document.getElementById("invitadosPanel").style.display = "block";
      const output = document.getElementById("output");
      const buscar = document.getElementById("buscar");

      let snapshot = await db.collection("invitados").orderBy("nombre").get();
      let invitados = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

      function render(filtro = "") {
        output.innerHTML = "";
        const filtrados = invitados.filter(i => i.nombre.toLowerCase().includes(filtro.toLowerCase()));
        filtrados.forEach(inv => {
          const div = document.createElement("div");
          div.className = "nombre";

          const span = document.createElement("span");
          span.textContent = inv.nombre;

          const btn = document.createElement("button");
          btn.textContent = inv.asistio ? "✅ Asistió" : "Marcar asistencia";
          btn.disabled = inv.asistio;

          btn.onclick = async () => {
            await db.collection("invitados").doc(inv.id).update({ asistio: true });
            inv.asistio = true;
            btn.textContent = "✅ Asistió";
            btn.disabled = true;
            actualizarProgreso();
          };

          div.appendChild(span);
          div.appendChild(btn);
          output.appendChild(div);
        });
        actualizarProgreso();
      }

      function actualizarProgreso() {
        const total = invitados.length;
        const asistieron = invitados.filter(i => i.asistio).length;
        const porcentaje = (asistieron / total) * 100;
        document.getElementById("progressFill").style.width = porcentaje + "%";
      }

      render();
      buscar.addEventListener("input", e => render(e.target.value));
    }
  </script>
</body>
</html>
